<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>van thyne custom furniture</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      margin: 0;
      font-family: "MS Sans Serif", system-ui, sans-serif;
      background: #6e6e6e; /* flat muted gray */
      color: #000;
      cursor: default;
      overflow: hidden;
    }

    a {
      color: #0000aa;
      text-decoration: underline;
      cursor: pointer;
    }

    .desktop {
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Top header */
    .menu-bar {
      background: #6e6e6e;
      color: #000;
      padding: 6px 8px;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 2px solid #000;
      box-sizing: border-box;
      z-index: 50;
      position: relative;
    }

    .menu-left {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .menu-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .header-box {
      border: 2px solid #000;
      background: #c8c8c8;
      box-shadow: 2px 2px 0 #000;
      padding: 4px 8px;
      text-transform: none;
      font-weight: bold;
      font-size: 12px;
      white-space: nowrap;
    }

    .header-logo-box {
      border: 2px solid #000;
      background: #c8c8c8;
      box-shadow: 2px 2px 0 #000;
      padding: 4px 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      white-space: nowrap;
      min-width: 60px;
      min-height: 36px;
    }

    .header-logo-box img {
      height: 28px;
      width: auto;
      display: block;
    }

    .home-button {
      border: 2px solid #000;
      background: #c4c4c4;
      padding: 2px 10px;
      font-size: 11px;
      cursor: pointer;
      box-shadow: 2px 2px 0 #000;
      text-transform: lowercase;
    }

    .home-button:active {
      box-shadow: 1px 1px 0 #000;
      transform: translate(1px, 1px);
    }

    .content {
      flex: 1;
      padding: 12px;
      box-sizing: border-box;
      position: relative;
      overflow: hidden;
    }

    /* Window / popup styles */
    .window {
      position: absolute;
      top: 80px;
      left: 80px;
      background: #c8c8c8;
      border: 2px solid #000;
      box-shadow: 4px 4px 0 #000;
      min-width: 220px;
      max-width: 90vw;
      max-height: 70vh; /* leave room for dock + banner */
      font-size: 12px;
      z-index: 10;
      display: flex;
      flex-direction: column;
      box-sizing: border-box;
    }

    .window.hidden {
      display: none;
    }

    .window-template {
      display: none; /* templates stay hidden */
    }

    .title-bar {
      padding: 3px 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-sizing: border-box;
      cursor: move;
      flex-shrink: 0;
      color: #f0f0f0;
      touch-action: none;
    }

    .title-bar .title {
      font-weight: bold;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .title-bar .controls {
      display: flex;
      gap: 2px;
    }

    .title-bar button {
      width: 18px;
      height: 18px;
      border: 1px solid #5c0000;
      background: #992222;
      color: #fff;
      font-size: 10px;
      line-height: 1;
      padding: 0;
      cursor: pointer;
    }

    .window-body {
      padding: 8px;
      overflow: auto;
      max-height: calc(70vh - 26px);
      box-sizing: border-box;
    }

    .window-body p {
      margin-top: 0;
      margin-bottom: 8px;
    }

    .window-body img {
      max-width: 100%;
      image-rendering: pixelated;
      border: 1px solid #000;
      display: block;
      margin-bottom: 8px;
    }

    .button-row {
      margin-top: 8px;
      text-align: right;
    }

    .retro-button {
      border: 2px solid #003354;
      background: #e0e0e0;
      padding: 2px 10px;
      font-size: 11px;
      cursor: pointer;
      box-shadow: 2px 2px 0 #000;
      text-transform: lowercase;
    }

    .retro-button:active {
      box-shadow: 1px 1px 0 #000;
      transform: translate(1px, 1px);
    }

    .small-text {
      font-size: 11px;
    }

    .input-row {
      display: flex;
      gap: 6px;
      margin-top: 6px;
      align-items: center;
      flex-wrap: wrap;
    }

    .input-column {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-top: 6px;
    }

    .input-row input,
    .input-row textarea,
    .input-column input,
    .input-column textarea {
      font-family: inherit;
      font-size: 11px;
      padding: 2px 4px;
      border: 1px solid #000;
      background: #f0f0f0;
      min-width: 160px;
      max-width: 50vw;
      box-sizing: border-box;
    }

    .input-column textarea {
      resize: vertical;
    }

    .image-grid {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .image-grid img {
      max-height: 140px;
      object-fit: cover;
    }

    /* THEME COLORS PER WINDOW */

    /* About window – blue */
    .window-about .title-bar {
      background: linear-gradient(to right, #003354, #00436a);
    }
    .window-about .window-body {
      background-image:
        repeating-linear-gradient(0deg, #c8c8c8 0, #c8c8c8 2px, #bcbcbc 2px, #bcbcbc 3px);
    }

    /* Past works – gray */
    .window-past .title-bar {
      background: linear-gradient(to right, #4f4f4f, #6c6c6c);
    }
    .window-past .window-body {
      background-image:
        repeating-linear-gradient(0deg, #d0d0d0 0, #d0d0d0 2px, #c2c2c2 2px, #c2c2c2 3px);
    }

    /* Request / new projects – green */
    .window-request .title-bar {
      background: linear-gradient(to right, #245c2b, #3c8a44);
    }
    .window-request .window-body {
      background-image:
        repeating-linear-gradient(0deg, #d6e6d8 0, #d6e6d8 2px, #c9dacb 2px, #c9dacb 3px);
    }
    .window-request .retro-button {
      border-color: #245c2b;
    }

    /* Contact – simple gray */
    .window-contact .title-bar {
      background: linear-gradient(to right, #555555, #777777);
    }
    .window-contact .window-body {
      background-image:
        repeating-linear-gradient(0deg, #d2d2d2 0, #d2d2d2 2px, #c6c6c6 2px, #c6c6c6 3px);
    }

    /* Bottom dock + banner */
    .bottom-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      z-index: 60;
      display: flex;
      flex-direction: column;
      align-items: stretch;
    }

    .dock {
      background: #3d3d3d;
      border-top: 2px solid #000;
      padding: 4px 8px;
      display: flex;
      justify-content: flex-start;
      gap: 12px;
      box-shadow: 0 -2px 0 #000;
    }

    .dock-icon {
      width: 44px;
      height: 44px;
      border: 2px solid #000;
      background: #c8c8c8;
      box-shadow: 2px 2px 0 #000;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      cursor: pointer;
      text-align: center;
      padding: 4px 2px;
      box-sizing: border-box;
    }

    .dock-icon-symbol {
      font-size: 14px;
      margin-bottom: 2px;
    }

    .dock-icon:active {
      box-shadow: 1px 1px 0 #000;
      transform: translate(1px, 1px);
    }

    .ticker {
      position: relative;
      overflow: hidden;
      background: #111;
      color: #f0f0f0;
      font-size: 11px;
      border-top: 1px solid #000;
      padding: 2px 0;
      box-sizing: border-box;
    }

    .ticker-inner {
      display: inline-block;
      white-space: nowrap;
      padding-left: 100%;
      animation: tickerMove 32s linear infinite;
    }

    @keyframes tickerMove {
      0% {
        transform: translateX(0%);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    /* MOBILE TWEAKS */
    @media (max-width: 600px) {
      .menu-bar {
        font-size: 11px;
        padding: 4px 6px;
      }

      .header-box {
        font-size: 11px;
        padding: 3px 6px;
      }

      .header-logo-box {
        font-size: 10px;
        padding: 3px 6px;
      }

      .header-logo-box img {
        height: 22px;
      }

      .home-button {
        padding: 2px 8px;
        font-size: 10px;
      }

      .content {
        padding: 8px;
        font-size: 11px;
      }

      .window {
        min-width: 80vw;
        max-width: 96vw;
        max-height: 62vh;
      }

      .title-bar {
        padding: 5px 8px;
      }

      .title-bar button {
        width: 24px;
        height: 24px;
        font-size: 12px;
      }

      .window-body {
        max-height: calc(62vh - 30px);
      }

      .image-grid img {
        max-height: 120px;
      }

      .input-row input,
      .input-row textarea,
      .input-column input,
      .input-column textarea {
        max-width: 100%;
        flex: 1 1 100%;
      }

      .retro-button {
        font-size: 10px;
        padding: 2px 8px;
      }

      .dock {
        gap: 8px;
        padding: 4px 6px;
      }

      .dock-icon {
        width: 40px;
        height: 40px;
        font-size: 9px;
      }

      .dock-icon-symbol {
        font-size: 13px;
      }

      .ticker {
        font-size: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="desktop">
    <div class="menu-bar">
      <div class="menu-left">
        <div class="header-box">van thyne custom furniture</div>
      </div>
      <div class="menu-right">
        <div class="header-logo-box">
          <img src="vanthynecustomfurniturelogo.png" alt="van thyne custom furniture logo">
        </div>
        <button class="home-button" onclick="window.location.href='index.html'">
          home
        </button>
      </div>
    </div>

    <div class="content">
      <!-- windows are dynamically added here -->
    </div>
  </div>

  <!-- Bottom dock + banner -->
  <div class="bottom-bar">
    <div class="dock">
      <!-- new project -->
      <div class="dock-icon" id="dockRequest">
        <div class="dock-icon-symbol">+</div>
        <div>new</div>
      </div>
      <!-- about -->
      <div class="dock-icon" id="dockAbout">
        <div class="dock-icon-symbol">?</div>
        <div>about</div>
      </div>
      <!-- past works -->
      <div class="dock-icon" id="dockPast">
        <div class="dock-icon-symbol">★</div>
        <div>works</div>
      </div>
      <!-- contact -->
      <div class="dock-icon" id="dockContact">
        <div class="dock-icon-symbol">i</div>
        <div>contact</div>
      </div>
      <!-- close all -->
      <div class="dock-icon" id="dockClose">
        <div class="dock-icon-symbol">×</div>
        <div>close</div>
      </div>
    </div>
    <div class="ticker">
      <div class="ticker-inner">
        welcome to van thyne custom furniture – hit the plus to start a project request • welcome to van thyne custom furniture – hit the plus to start a project request •
      </div>
    </div>
  </div>

  <!-- WINDOW TEMPLATES (hidden) -->

  <!-- About template -->
  <div class="window window-about window-template" id="aboutTemplate">
    <div class="title-bar">
      <div class="title">about – van thyne custom furniture</div>
      <div class="controls">
        <button class="close-btn">X</button>
      </div>
    </div>
    <div class="window-body">
      <p>
        jack van thyne is a student at uc berkeley studying landscape architecture
        with a focus on furniture design and research in wood construction and forest management.
      </p>
      <p>
        van thyne custom furniture designs and builds custom pieces in the bay area,
        often using reclaimed or locally sourced lumber. each project becomes a collaboration
        between the client, the site, and the material.
      </p>
      <p>
        the work sits between architecture, furniture, and landscape. pieces are meant to feel
        honest about their structure so the way they are built and where the wood came from
        remains legible.
      </p>
      <p>
        materials are treated as a record of place and use. dents, grain shifts, and repairs
        are part of the design language rather than details to hide.
      </p>
    </div>
  </div>

  <!-- Past Works template -->
  <div class="window window-past window-template" id="pastTemplate">
    <div class="title-bar">
      <div class="title">past_works / images</div>
      <div class="controls">
        <button class="close-btn">X</button>
      </div>
    </div>
    <div class="window-body">
      <p class="small-text">
        some past projects:
      </p>
      <div class="image-grid">
        <img src="furniturepastworkimage001.jpg" alt="past project 001">
        <img src="furniturepastworkimage002.jpg" alt="past project 002">
        <img src="furniturepastworkimage003.jpg" alt="past project 003">
        <img src="furniturepastworkimage004.jpg" alt="past project 004">
        <img src="furniturepastworkimage005.jpg" alt="past project 005">
      </div>
    </div>
  </div>

  <!-- Request / Schedule / Project code template -->
  <div class="window window-request window-template" id="requestTemplate">
    <div class="title-bar">
      <div class="title">new projects</div>
      <div class="controls">
        <button class="close-btn">X</button>
      </div>
    </div>
    <div class="window-body">
      <p>
        van thyne custom furniture offers a free preliminary design consultation for new projects.
      </p>

      <p class="small-text"><strong>enter a project code</strong></p>
      <p class="small-text">
        if a project has an associated code (for example from a past collaboration),
        it can be entered here. clicking <strong>reach out</strong> will open a project window.
      </p>
      <div class="input-row">
        <input type="text" class="project-code-input" placeholder="enter project code (if applicable)">
        <button class="retro-button project-code-button">reach out</button>
      </div>

      <hr>

      <p class="small-text"><strong>start a new project</strong></p>
      <p class="small-text">
        to start a new project, basic information can be sent as a draft email below.
      </p>
      <div class="input-column">
        <input type="text" class="new-project-title" placeholder="project name or type">
        <input type="text" class="new-project-location" placeholder="location (city, state)">
        <textarea class="new-project-details" rows="4" placeholder="project details and description"></textarea>
      </div>
      <div class="button-row">
        <button class="retro-button new-project-submit">submit request</button>
      </div>
    </div>
  </div>

  <!-- Contact template -->
  <div class="window window-contact window-template" id="contactTemplate">
    <div class="title-bar">
      <div class="title">contact information</div>
      <div class="controls">
        <button class="close-btn">X</button>
      </div>
    </div>
    <div class="window-body">
      <p>name: jack van thyne</p>
      <p>location: berkeley, california</p>
      <p>
        email:
        <a href="mailto:jjvanthyne">jjvanthyne</a>
      </p>
    </div>
  </div>

  <!-- Project window (single, dynamic) -->
  <div class="window window-about hidden" id="projectWindow">
    <div class="title-bar">
      <div class="title" id="projectWindowTitle">project</div>
      <div class="controls">
        <!-- inline close to guarantee behavior -->
        <button class="close-btn" onclick="document.getElementById('projectWindow').classList.add('hidden')">X</button>
      </div>
    </div>
    <div class="window-body">
      <img id="projectImage" src="" alt="project image" style="display:none;">
      <p id="projectText"></p>
      <div class="button-row">
        <button class="retro-button" id="projectConsultButton">
          schedule consultation about this project
        </button>
      </div>
      <p class="small-text" id="projectCodeNote"></p>
    </div>
  </div>

  <script>
    // Project codes and preset popup content
    const PROJECTS = {
      "thehiddencafe": {
        title: "TheHiddenCafe",
        code: "TheHiddenCafe",
        image: "TheHiddenCafe.jpg",
        text: "TheHiddenCafe is a compact built-in cafe corner, combining seating, storage, and shelving to create a quiet place for coffee inside a larger space."
      },
      "fava": {
        title: "FAVA",
        code: "FAVA",
        image: "FAVA.jpg",
        text: "FAVA is a flexible table and bench system developed for shared meals and gatherings, using simple joinery and durable finishes for everyday use."
      },
      "lucindasdeli": {
        title: "LucindasDeli",
        code: "LucindasDeli",
        image: "LucindasDeli.jpg",
        text: "LucindasDeli features custom shelving and counter elements designed to frame food, light, and circulation within a small neighborhood deli setting."
      },
      "thelaundromat": {
        title: "TheLaundromat",
        code: "TheLaundromat",
        image: "TheLaundromat.jpg",
        text: "TheLaundromat is a series of benches, folding surfaces, and partitions that organize waiting, working, and conversation in a laundromat environment."
      }
    };

    // global dragging state
    let activeWindow = null;
    let offsetX = 0;
    let offsetY = 0;

    // last positions per template for stacked spawning
    const lastSpawnPositions = {};

    function bringToFront(win) {
      const maxZ = Array.from(document.querySelectorAll(".window"))
        .reduce((m, w) => Math.max(m, parseInt(window.getComputedStyle(w).zIndex) || 0), 10);
      win.style.zIndex = maxZ + 1;
    }

    function clampWindowToViewport(el) {
      const viewportWidth = window.innerWidth;
      const viewportHeight = window.innerHeight;
      const rect = el.getBoundingClientRect();

      let left = rect.left;
      let top = rect.top;

      const maxLeft = Math.max(0, viewportWidth - rect.width - 4);
      const maxTop = Math.max(24, viewportHeight - rect.height - 70); // keep above dock/banner

      if (left < 0) left = 0;
      if (top < 0) top = 0;
      if (left > maxLeft) left = maxLeft;
      if (top > maxTop) top = maxTop;

      el.style.left = left + "px";
      el.style.top = top + "px";
    }

    function placeWindowRandom(el) {
      const viewportWidth = window.innerWidth;
      const viewportHeight = window.innerHeight;

      el.style.display = "block";
      const rect = el.getBoundingClientRect();

      const maxLeft = Math.max(0, viewportWidth - rect.width - 16);
      const maxTop = Math.max(24, viewportHeight - rect.height - 90);

      const left = Math.floor(Math.random() * (maxLeft + 1));
      const top = Math.floor(Math.random() * (maxTop + 1));

      el.style.left = left + "px";
      el.style.top = top + "px";

      bringToFront(el);
      return { left, top };
    }

    function placeWindowStacked(el, prevPos) {
      const viewportWidth = window.innerWidth;
      const viewportHeight = window.innerHeight;

      el.style.display = "block";
      const rect = el.getBoundingClientRect();

      let left = prevPos.left + 24;
      let top = prevPos.top + 24;

      const maxLeft = Math.max(0, viewportWidth - rect.width - 16);
      const maxTop = Math.max(24, viewportHeight - rect.height - 90);

      if (left > maxLeft) left = 0;
      if (top > maxTop) top = 24;

      el.style.left = left + "px";
      el.style.top = top + "px";

      bringToFront(el);
      return { left, top };
    }

    function positionWindowRandomElement(el) {
      placeWindowRandom(el);
    }

    function initWindow(win) {
      // bring to front when interacting
      win.addEventListener("mousedown", () => bringToFront(win));
      win.addEventListener("touchstart", () => bringToFront(win), { passive: true });

      const bar = win.querySelector(".title-bar");
      if (bar) {
        bar.addEventListener("mousedown", function (e) {
          activeWindow = win;
          bringToFront(win);
          const rect = win.getBoundingClientRect();
          offsetX = e.clientX - rect.left;
          offsetY = e.clientY - rect.top;
          e.preventDefault();
        });

        bar.addEventListener("touchstart", function (e) {
          const touch = e.touches[0];
          activeWindow = win;
          bringToFront(win);
          const rect = win.getBoundingClientRect();
          offsetX = touch.clientX - rect.left;
          offsetY = touch.clientY - rect.top;
          e.preventDefault();
        }, { passive: false });
      }

      clampWindowToViewport(win);
    }

    function spawnWindowFromTemplate(templateId, mode) {
      const template = document.getElementById(templateId);
      if (!template) return;

      const clone = template.cloneNode(true);
      const uniqueId = templateId + "_clone_" + Date.now() + "_" + Math.floor(Math.random() * 1000);
      clone.id = uniqueId;
      clone.classList.remove("window-template");
      clone.classList.remove("hidden");
      document.body.appendChild(clone);
      initWindow(clone);

      let pos;
      const prev = lastSpawnPositions[templateId];
      if (mode === "stack" && prev) {
        pos = placeWindowStacked(clone, prev);
      } else {
        pos = placeWindowRandom(clone);
      }
      lastSpawnPositions[templateId] = pos;
    }

    function closeAllWindows() {
      document.querySelectorAll(".window").forEach(win => {
        if (win.classList.contains("window-template")) return; // keep templates
        if (win.id === "projectWindow") {
          win.classList.add("hidden");
        } else {
          win.remove();
        }
      });
    }

    function openProjectFromCode(codeRaw) {
      if (!codeRaw) return;
      const key = codeRaw.trim().toLowerCase();
      if (!key) return;

      const project = PROJECTS[key];
      if (!project) {
        window.alert(
          "unknown project code.\n\nrecognized codes include: TheHiddenCafe, FAVA, LucindasDeli, TheLaundromat."
        );
        return;
      }

      const win = document.getElementById("projectWindow");
      const titleEl = document.getElementById("projectWindowTitle");
      const imgEl = document.getElementById("projectImage");
      const textEl = document.getElementById("projectText");
      const noteEl = document.getElementById("projectCodeNote");
      const btnEl = document.getElementById("projectConsultButton");

      titleEl.textContent = project.title + " (" + project.code + ")";
      textEl.textContent = project.text;

      if (project.image && project.image.length > 0) {
        imgEl.src = project.image;
        imgEl.style.display = "block";
      } else {
        imgEl.style.display = "none";
      }

      noteEl.textContent = "project code: " + project.code;

      btnEl.onclick = function () {
        const email = "jjvanthyne";
        const subject = encodeURIComponent("preliminary design consultation – " + project.code);
        const body = encodeURIComponent(
          "hello,\n\nthis email is about project " + project.code + ".\n\n" +
          "a few possible times for a preliminary consultation can be suggested here.\n\nbest,\n"
        );
        window.location.href = "mailto:" + email + "?subject=" + subject + "&body=" + body;
      };

      win.classList.remove("hidden");
      initWindow(win);
      positionWindowRandomElement(win);
    }

    // Drag move handlers
    document.addEventListener("mousemove", function (e) {
      if (!activeWindow) return;

      const viewportWidth = window.innerWidth;
      const viewportHeight = window.innerHeight;
      const rect = activeWindow.getBoundingClientRect();
      let newLeft = e.clientX - offsetX;
      let newTop = e.clientY - offsetY;

      const maxLeft = viewportWidth - rect.width - 4;
      const maxTop = viewportHeight - rect.height - 70;

      if (newLeft < 0) newLeft = 0;
      if (newTop < 0) newTop = 0;
      if (newLeft > maxLeft) newLeft = maxLeft;
      if (newTop > maxTop) newTop = maxTop;

      activeWindow.style.left = newLeft + "px";
      activeWindow.style.top = newTop + "px";
    });

    document.addEventListener("mouseup", function () {
      activeWindow = null;
    });

    document.addEventListener("touchmove", function (e) {
      if (!activeWindow) return;
      const touch = e.touches[0];
      const viewportWidth = window.innerWidth;
      const viewportHeight = window.innerHeight;
      const rect = activeWindow.getBoundingClientRect();
      let newLeft = touch.clientX - offsetX;
      let newTop = touch.clientY - offsetY;

      const maxLeft = viewportWidth - rect.width - 4;
      const maxTop = viewportHeight - rect.height - 70;

      if (newLeft < 0) newLeft = 0;
      if (newTop < 0) newTop = 0;
      if (newLeft > maxLeft) newLeft = maxLeft;
      if (newTop > maxTop) newTop = maxTop;

      activeWindow.style.left = newLeft + "px";
      activeWindow.style.top = newTop + "px";

      e.preventDefault();
    }, { passive: false });

    document.addEventListener("touchend", function () {
      activeWindow = null;
    });

    // Global close button handler (for all X's, including clones)
    document.addEventListener("click", function (e) {
      if (e.target.classList.contains("close-btn")) {
        const win = e.target.closest(".window");
        if (!win) return;
        if (win.id === "projectWindow") {
          win.classList.add("hidden");
        } else {
          win.remove();
        }
        return;
      }

      // project code reach out
      if (e.target.classList.contains("project-code-button")) {
        const win = e.target.closest(".window-request");
        if (!win) return;
        const input = win.querySelector(".project-code-input");
        if (!input) return;
        openProjectFromCode(input.value);
        return;
      }

      // new project submit
      if (e.target.classList.contains("new-project-submit")) {
        const win = e.target.closest(".window-request");
        if (!win) return;
        const titleInput = win.querySelector(".new-project-title");
        const locationInput = win.querySelector(".new-project-location");
        const detailsInput = win.querySelector(".new-project-details");

        const title = titleInput ? titleInput.value.trim() : "";
        const location = locationInput ? locationInput.value.trim() : "";
        const details = detailsInput ? detailsInput.value.trim() : "";

        const email = "jjvanthyne";
        const subjectBase = title || "new custom furniture project";
        const subject = encodeURIComponent("project request – " + subjectBase);

        let body = "hello,\n\n";
        body += "a new project request is being submitted.\n\n";
        if (title) body += "project name / type: " + title + "\n";
        if (location) body += "location: " + location + "\n";
        if (details) {
          body += "\nproject details and description:\n" + details + "\n";
        }
        body += "\nplease reply with a few possible times for a preliminary consultation.\n\nbest,\n";

        window.location.href = "mailto:" + email + "?subject=" + subject + "&body=" + encodeURIComponent(body);
      }
    });

    document.addEventListener("keydown", function (e) {
      if (e.key === "Enter" && e.target.classList.contains("project-code-input")) {
        openProjectFromCode(e.target.value);
      }
    });

    document.addEventListener("DOMContentLoaded", function () {
      // Initialize project window behavior
      const projectWin = document.getElementById("projectWindow");
      if (projectWin) {
        initWindow(projectWin);
        projectWin.classList.add("hidden");
      }

      // Automatically open NEW PROJECTS popup on load
      spawnWindowFromTemplate("requestTemplate", "auto");
      // Also open about / works / contact if you still want all popups on load:
      spawnWindowFromTemplate("aboutTemplate", "auto");
      spawnWindowFromTemplate("pastTemplate", "auto");
      spawnWindowFromTemplate("contactTemplate", "auto");

      // Dock actions: spawn new instances from templates, stacked
      document.getElementById("dockRequest").addEventListener("click", function () {
        spawnWindowFromTemplate("requestTemplate", "stack");
      });

      document.getElementById("dockAbout").addEventListener("click", function () {
        spawnWindowFromTemplate("aboutTemplate", "stack");
      });

      document.getElementById("dockPast").addEventListener("click", function () {
        spawnWindowFromTemplate("pastTemplate", "stack");
      });

      document.getElementById("dockContact").addEventListener("click", function () {
        spawnWindowFromTemplate("contactTemplate", "stack");
      });

      document.getElementById("dockClose").addEventListener("click", function () {
        closeAllWindows();
      });

      // Re-clamp windows on resize
      window.addEventListener("resize", function () {
        document.querySelectorAll(".window:not(.window-template)").forEach(clampWindowToViewport);
      });
    });
  </script>
</body>
</html>
